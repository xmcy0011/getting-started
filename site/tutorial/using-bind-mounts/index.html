<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Getting Started with Docker"><meta name=author content=Docker><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-4.6.3"><title>绑定挂载 - Getting Started</title><link rel=stylesheet href=../../assets/stylesheets/application.adb8469c.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content=#2196f3><script src=../../assets/javascripts/modernizr.86422ebf.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css><link rel=stylesheet href=../../css/styles.css><link rel=stylesheet href=../../css/dark-mode.css></head> <body dir=ltr data-md-color-primary=blue data-md-color-accent=blue> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#2 tabindex=0 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=../.. title="Getting Started" aria-label="Getting Started" class="md-header-nav__button md-logo"> <img alt=logo src=../../images/docker-labs-logo.svg width=24 height=24> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Getting Started </span> <span class=md-header-nav__topic> 绑定挂载 </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input aria-label=search name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/xmcy0011/getting-started title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> docker/getting-started </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=../.. title="Getting Started" class="md-nav__button md-logo"> <img alt=logo src=../../images/docker-labs-logo.svg width=48 height=48> </a> Getting Started </label> <div class=md-nav__source> <a href=https://github.com/xmcy0011/getting-started title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> docker/getting-started </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ title=开始 class=md-nav__link> 开始 </a> </li> <li class=md-nav__item> <a href=../our-application/ title=示例程序 class=md-nav__link> 示例程序 </a> </li> <li class=md-nav__item> <a href=../updating-our-app/ title=更新镜像 class=md-nav__link> 更新镜像 </a> </li> <li class=md-nav__item> <a href=../sharing-our-app/ title=上传镜像 class=md-nav__link> 上传镜像 </a> </li> <li class=md-nav__item> <a href=../persisting-our-data/ title=持久化DB class=md-nav__link> 持久化DB </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 绑定挂载 </label> <a href=./ title=绑定挂载 class="md-nav__link md-nav__link--active"> 绑定挂载 </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#2 class=md-nav__link> 快速比较2中卷类型 </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 启动开发模式的容器 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 总结 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../multi-container-apps/ title=多容器应用 class=md-nav__link> 多容器应用 </a> </li> <li class=md-nav__item> <a href=../using-docker-compose/ title="使用Docker Compose" class=md-nav__link> 使用Docker Compose </a> </li> <li class=md-nav__item> <a href=../image-building-best-practices/ title=构建镜像最佳实践 class=md-nav__link> 构建镜像最佳实践 </a> </li> <li class=md-nav__item> <a href=../what-next/ title=接下来? class=md-nav__link> 接下来? </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#2 class=md-nav__link> 快速比较2中卷类型 </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 启动开发模式的容器 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 总结 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>绑定挂载</h1> <!-- In the previous chapter, we talked about and used a **named volume** to persist the data in our database.
Named volumes are great if we simply want to store data, as we don't have to worry about _where_ the data
is stored. --> <p>在上一章中，我们讨论并使用 <code>命名卷（named volume）</code> 来持久化数据库中的数据。如果我们只想存储数据，命名卷就很棒，因为我们不必担心数据在哪里存储。</p> <!-- With **bind mounts**, we control the exact mountpoint on the host. We can use this to persist data, but is often
used to provide additional data into containers. When working on an application, we can use a bind mount to
mount our source code into the container to let it see code changes, respond, and let us see the changes right
away. --> <p>除此之外，我们还可以使用 <code>绑定挂载（bind mounts）</code> 来存储数据，和命名卷（PS：译者更喜欢称其为数据卷或者数据卷容器）不同的是： - 您可以控制主机上的确切挂载点，将容器的数据存储在宿主机何处将由您来决定。 - 用它来向容器提供额外的数据。比如我们可以使用绑定挂载来将我们的源代码装载到容器中，让它看到代码更改（这一特性对于前端应用特别有帮助）或者加载宿主机的配置文件等等。</p> <!-- For Node-based applications, [nodemon](https://npmjs.com/package/nodemon) is a great tool to watch for file
changes and then restart the application. There are equivalent tools in most other languages and frameworks. --> <p>对于基于NodeJs的应用程序来说，<code>nodemon</code> 是监视文件的绝佳工具，一旦其发现文件改动，就会自动重新启动应用程序。大多数其他语言和框架都有同等的工具。</p> <!-- ## Quick Volume Type Comparisons --> <h2 id=2>快速比较2中卷类型<a class=headerlink href=#2 title="Permanent link">&para;</a></h2> <!-- Bind mounts and named volumes are the two main types of volumes that come with the Docker engine. However, additional
volume drivers are available to support other use cases ([SFTP](https://github.com/vieux/docker-volume-sshfs), [Ceph](https://ceph.com/geen-categorie/getting-started-with-the-docker-rbd-volume-plugin/), [NetApp](https://netappdvp.readthedocs.io/en/stable/), [S3](https://github.com/elementar/docker-s3-volume), and more). --> <p>绑定挂载和命名卷是Docker引擎默认的两种主要卷类型。然而，额外的 卷驱动程序可用于支持其他用例（<a href=https://github.com/vieux/docker-volume-sshfs>SFTP</a>、<a href=https://ceph.com/geen-categorie/getting-started-with-the-docker-rbd-volume-plugin/ >Ceph</a>、<a href=https://netappdvp.readthedocs.io/en/stable/ >NetApp</a>、<a href=https://github.com/elementar/docker-s3-volume>S3</a>, and more)等）。</p> <!-- |   | Named Volumes | Bind Mounts |
| - | ------------- | ----------- |
| Host Location | Docker chooses | You control |
| Mount Example (using `-v`) | my-volume:/usr/local/data | /path/to/data:/usr/local/data |
| Populates new volume with container contents | Yes | No |
| Supports Volume Drivers | Yes | No | --> <table> <thead> <tr> <th></th> <th>命名卷</th> <th>绑定挂载</th> </tr> </thead> <tbody> <tr> <td>主机位置</td> <td>Docker选择</td> <td>你控制</td> </tr> <tr> <td>挂载示例（使用<code>-v</code>）</td> <td>my-volume:/usr/local/data</td> <td>/your/host/path:/usr/local/data</td> </tr> <tr> <td>用容器内容填充新卷</td> <td>是</td> <td>否</td> </tr> <tr> <td>支持卷驱动程序</td> <td>是</td> <td>否</td> </tr> </tbody> </table> <!-- ## Starting a Dev-Mode Container --> <h2 id=_1>启动开发模式的容器<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <!-- To run our container to support a development workflow, we will do the following: --> <p>要运行我们的容器以支持开发工作流程，我们将执行以下操作：</p> <!-- - Mount our source code into the container
- Install all dependencies, including the "dev" dependencies
- Start nodemon to watch for filesystem changes --> <ul> <li>将我们的源代码装入容器</li> <li>安装所有依赖项，包括“开发”依赖项</li> <li>启动 <code>nodemon</code> 以监视文件系统更改</li> </ul> <!-- So, let's do it! --> <p>所以，我们开始吧！</p> <!-- 1. Make sure you don't have any previous `getting-started` containers running.
2. Run the following command. We'll explain what's going on afterwards: --> <ol> <li>确保您之前没有任何 <code>getting-started</code> 容器在运行。</li> <li> <p>运行以下命令。我们将稍后解释发生了什么： <div class=highlight><pre><span></span><code>docker run -dp <span class=m>3000</span>:3000 <span class=se>\</span>
    -w /app -v <span class=s2>&quot;</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span><span class=s2>:/app&quot;</span> <span class=se>\</span>
    node:12-alpine <span class=se>\</span>
    sh -c <span class=s2>&quot;yarn install &amp;&amp; yarn run dev&quot;</span>
</code></pre></div></p> <p>如果您使用的是PowerShell，请使用此命令。</p> <div class=highlight><pre><span></span><code><span class=n>docker</span> <span class=n>run</span> <span class=n>-dp</span> <span class=n>3000</span><span class=err>:</span><span class=n>3000</span> <span class=p>`</span>
    <span class=n>-w</span> <span class=p>/</span><span class=n>app</span> <span class=n>-v</span> <span class=s2>&quot;</span><span class=p>$(</span><span class=n>pwd</span><span class=p>)</span><span class=s2>:/app&quot;</span> <span class=p>`</span>
    <span class=n>node</span><span class=err>:</span><span class=n>12-alpine</span> <span class=p>`</span>
    <span class=n>sh</span> <span class=n>-c</span> <span class=s2>&quot;yarn install &amp;&amp; yarn run dev&quot;</span>
</code></pre></div> <ul> <li><code>-dp 3000:3000</code>：和以前一样。后台模式运行容器，并创建端口映射。</li> <li><code>-w /app</code>：设置命令的“工作目录”。</li> <li><code>-v "$(pwd):/app"</code>：使用绑定挂载将当前主机目录绑定到容器中的/app目录。</li> <li><code>node:12-alpine</code>：要使用的镜像。请注意，这是从我们应用程序Dockerfile中指定的基础镜像。</li> <li><code>sh -c "yarn install &amp;&amp; yarn run dev"</code>：我们使用sh命令启动一个shell（带alpine名字的镜像没有bash工具），然后运行yarn install安装所有依赖项，最后运行yarn run dev启动Node应用程序。如果我们查看package.json，我们将看到dev脚本正在启动nodemon。</li> </ul> </li> <li> <p>当使用 <code>docker logs -f &lt;container-id&gt;</code> 查看到实时日志后，你就知道你成功启动了应用。</p> <div class=highlight><pre><span></span><code>docker logs -f &lt;container-id&gt;
$ nodemon src/index.js
<span class=o>[</span>nodemon<span class=o>]</span> <span class=m>1</span>.19.2
<span class=o>[</span>nodemon<span class=o>]</span> to restart at any time, enter <span class=sb>`</span>rs<span class=sb>`</span>
<span class=o>[</span>nodemon<span class=o>]</span> watching dir<span class=o>(</span>s<span class=o>)</span>: *.*
<span class=o>[</span>nodemon<span class=o>]</span> starting <span class=sb>`</span>node src/index.js<span class=sb>`</span>
Using sqlite database at /etc/todos/todo.db
Listening on port <span class=m>3000</span>
</code></pre></div> <p>我们可以通过同时按住 <code>Ctrl</code>+<code>C</code> 退出监听实时日志。</p> </li> <li> <p>现在，让我们更改一下应用程序。在 <code>src/static/js/app.js</code> 文件的 <code>109行</code>，让我们将“添加项目”按钮更改为"添加"。 <div class=highlight><pre><span></span><code><span class=gd>- {submitting ? &#39;Adding...&#39; : &#39;Add Item&#39;}</span>
<span class=gi>+ {submitting ? &#39;Adding...&#39; : &#39;Add&#39;}</span>
</code></pre></div></p> </li> <li> <p>只需刷新页面（或打开页面），您几乎可以立即在浏览器中看到更改效果。当然，有可能Node服务器需要几秒钟重新启动，因此如果发生错误，您只需在几秒钟后尝试刷新即可。</p> <p class=text-center><img alt="Screenshot of updated label for Add button" src=updated-add-button.png style=width:75%;></p> </li> <li> <p>请随时进行任何其他您想要的更改。完成后，停止容器，并通过命令 <code>docker build -t getting-started .</code> 构建新镜像。</p> </li> </ol> <!-- Using bind mounts is _very_ common for local development setups. The advantage is that the dev machine doesn't need to have
all of the build tools and environments installed. With a single `docker run` command, the dev environment is pulled and ready
to go. We'll talk about Docker Compose in a future step, as this will help simplify our commands (we're already getting a lot of flags). --> <p>使用绑定挂载一个非常常见的场景是：<code>充当本地开发的编译环境</code>。开发机不需要安装所有构建工具和环境，只需要使用单个<code>docker run</code>命令，开发环境就能一键就绪。</p> <p>我们将在未来进一步讨论 <code>Docker Compose</code>，因为这将有助于简化我们的命令（我们已经接触了很多命令参数）。</p> <h2 id=_2>总结<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <!-- At this point, we can persist our database and respond rapidly to the needs and demands of our investors and founders. Hooray!
But, guess what? We received great news! --> <p>此时，我们可以持久化存储我们的数据库，并快速响应投资者和创始人的需求和要求。万岁！ 但是，你猜怎么着？我们收到了好消息！</p> <!-- **Your project has been selected for future development!**  --> <p><strong>未来的规划中您的项目已被选中！</strong></p> <!-- In order to prepare for production, we need to migrate our database from working in SQLite to something that can scale a
little better. For simplicity, we'll keep with a relational database and switch our application to use MySQL. But, how 
should we run MySQL? How do we allow the containers to talk to each other? We'll talk about that next! --> <p>为了准备投入生产，我们需要将数据库从在SQLite中迁移，使用扩展性好一点的数据库。为了简单起见，我们将继续使用关系型数据库，从SQLite切换到使用MySQL。但是，我们应该如何运行MySQL？我们如何允许容器相互访问？接下来，让我们一起看看！</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../persisting-our-data/ title=持久化DB class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> 持久化DB </span> </div> </a> <a href=../multi-container-apps/ title=多容器应用 class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> 多容器应用 </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Docker </div> powered by <a href=https://www.mkdocs.org target=_blank rel=noopener>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <a href=https://github.com/xmcy0011/getting-started target=_blank rel=noopener title=github-alt class="md-footer-social__link fa fa-github-alt"></a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c33a9706.js></script> <script>app.initialize({version:"1.2.3",url:{base:"../.."}})</script> </body> </html>